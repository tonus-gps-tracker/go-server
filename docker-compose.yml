version: '3.8'

services:
  influxdb:
    image: influxdb:2.7.1
    container_name: 'sv-tracker-influxdb'
    restart: 'no'
    ports:
      - '${INFLUXDB_PORT-8086}:8086'
    volumes:
      - ./.docker/data/influxdb2:/var/lib/influxdb2
    environment:
      DOCKER_INFLUXDB_INIT_MODE: setup
      DOCKER_INFLUXDB_INIT_USERNAME: ${INFLUXDB_USERNAME}
      DOCKER_INFLUXDB_INIT_PASSWORD: ${INFLUXDB_PASSWORD}
      DOCKER_INFLUXDB_INIT_ORG: ${INFLUXDB_ORG}
      DOCKER_INFLUXDB_INIT_BUCKET: ${INFLUXDB_BUCKET}

  grafana:
    image: grafana/grafana:10.1.1
    container_name: 'sv-tracker-grafana'
    restart: 'no'
    ports:
      - '${GRAFANA_PORT-3000}:3000'
    volumes:
      - ./.docker/data/grafana:/var/lib/grafana
    environment:
     - GF_INSTALL_PLUGINS=${INFLUXDB_PLUGINS}